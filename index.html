<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>HTML 5 Boilerplate</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <div>Teachable Machine Image Model</div>
    <button type='button' onclick='init()'>Start</button>
    <div id='webcam-container'></div>
    <div id='label-container'></div>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8.3/dist/teachablemachine-image.min.js"></script>
    <script type="text/javascript">
        // More API functions here:
        // https://github.com/googlecreativelab/teachablemachine-community/tree/master/libraries/image

        // the link to your model provided by Teachable Machine export panel
        const URL = 'https://teachablemachine.withgoogle.com/models/AojvAytZ6/';

        let model, webcam, labelContainer, maxPredictions;

        // Load the image model and setup the webcam
        async function init() {
            const modelURL = URL + 'model.json';
            const metadataURL = URL + 'metadata.json';

            // load the model and metadata
            // Refer to tmImage.loadFromFiles() in the API to support files from a file picker
            // or files from your local hard drive
            model = await tmImage.load(modelURL, metadataURL);
            maxPredictions = model.getTotalClasses();

            // Convenience function to setup a webcam
            const width = 200;
            const height = 200;
            const facingMode = { exact: "environment" };
            const constraints = {
                audio: false,
                video: {
                    width: { ideal: width },
                    height: { ideal: height },
                    facingMode: facingMode
                }
            };
            if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream) {
                const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);
                if (!isSafari) {
                    constraints.video.facingMode = facingMode;
                }
            }

            try {
                // Try to access the camera with the given constraints
                webcam = await tmImage.getWebcam(constraints);
            } catch (error) {
                // If the back camera is not available, switch to the front camera
                constraints.video.facingMode = "user";
                webcam = await tmImage.getWebcam(constraints);
            }

            document.getElementById("webcam-container").appendChild(webcam.canvas);

            // append elements to the DOM
            labelContainer = document.getElementById('label-container');
            for (let i = 0;
